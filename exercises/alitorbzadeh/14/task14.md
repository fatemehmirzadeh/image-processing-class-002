**سوال 14**
<br>
<div dir="rtl">
  شبکه ­های مولد متخاصم – Generative Adversarial Networks
 <br>

  
شبکه ­های مولد متخاصم با استفاده از معماری شبکه هhmای عصبی کانولوشنی قادرند تا از مجموعه ای از تصاویر (در اینجا، دیتاست) یاد بگیرد و تصاویری مشابه تصاویر واقعی اما کاملاً جدیدی که در دیتاست موجود نیست را تولید کند. این شبکه برای اولین بار توسط IanGoodfellow معرفی شد.

اجزای اصلی شبکه GAN:

دو جزء اساسی در GAN وجود دارد که سعی در بهبود شبکه برخلاف یکدیگر دارند:
مولد – تولید کننده که با خلق تصاویر بسیار نویزدار از دیتای ورودی که اغلب بصورت نویز گوسی به شبکه داده می­شود کار خود را شروع می ­نماید. وظیفه ه­ای که مولد باید در ادامه انجام دهد این است که تصاویری، تا حد ممکن حقیقی تولید کند که به اندازه­ی کافی طبیعی جلوه کنند.
تمیز دهنده- تشخیص دهنده که وظیفه آن، تشخیص تصاویر حقیقی از تصاویر جعلی است بدین صورت که با نگاه کردن به تصاویر تولیدی از مولد باید تشخیص دهد که تصاویر به انداز
ه ی کافی طبیعی جلوه می­ کنند یا خیر. این وظیفه را با مقایسه­ ی بین تصاویر دیتاست و تصاویر تولید شده توسط مولد انجام می ­دهد.
  ![image](https://user-images.githubusercontent.com/94124607/166116671-2a67d211-adad-4c7c-85cf-cddb134b0d48.png)
  هدف آن است که تصاویری ایجاد کنیم که به اندازه­ی تصاویر حقیقی، طبیعی جلوه کنند. به طوری که نه ­تنها قادر به فریب انسان باشد، بلکه قادر به فریب کامپیوتری که خود آنها را تولید کرده نیز باشد.
  
  ![image](https://user-images.githubusercontent.com/94124607/166116422-cbe2f985-2170-4f7e-a878-57677cd55b30.png)
  <div dir="rtl">
همواره برای توضیح شبکه های مولد متخاصم از مثال جاعل G و کارآگاه D نام برده می شود. بدین صورت که جاعل اسکناس برای اولین بار اسکناسی را جعل می نماید و آن به طریقی به دست کارآگاه می رساند. کارآگاه آن را با اسکناس حقیقی مقایسه می نماید و متوجه میشود که اسکناس جعلی است. او به همکاران خود گذارش می دهد و به این ترتیب جاعل از لو رفتن اسکناس تولیدی خود مطلع می گردد. جاعل پس از آن سعی در بهبود اسکناس های جعلی می نماید. برای تلاش بعدی دوباره اسکناس جعلی بهبود داده شده را به طریقی به دست کارآگاه می رساند. کارآگاه که از دفعه ی پیش تجربه کسب کرده بود با دقت بیشتری به بررسی آن می پردازد و سعی در بررسی بیشتر ظرافات موجود در اسکناس می نماید.بدین ترتیب کارآگاه دوباره به جعلی بودن اسکناس پی می¬برد. این کار تا زمانی تکرار می گردد که جاعل اسکناسی به اندازه ی کافی شبیه به اسکناس حقیقی تولید نماید که کارآگاه متوجه جعلی بودن اسکناس نگردد. پس از آن اسکناس های جعلی را به بازار عرضه می نماید.
در شبکه های مولد متخاصم، مولد همان جاعل است و تمیز دهنده همان کارآگاه است که وظیفه ی تشخیصی مهمی را بر عهده دارد.


فرض کنید تصویری داریم که تمیز دهنده D در حال آنالیز آن است. اگر تصویر به نظر نرمال یا طبیعی باشد، D مقداری نزدیک به ۰ به آن می دهد و اگر تصویر به نظر غیر طبیعی ( غیرحقیقی ) باشد مقداری نزدیک به ۱ (می-تواند برای مثال تصاویر بسیار نویز دار باشد) به آن می دهد. مولد G، بردار Z را از تصاویر رندوم نمونه برداری شده ی ساده، بطور مثال توزیع نرمال یا توزیع یکنواخت که شناخته شده اند، دریافت و سعی در تولید تصویری حقیقی می کند.
![image](https://user-images.githubusercontent.com/94124607/166116684-e3f2a7df-ac81-49ce-8c94-9a49faba527a.png)


تصاویری که توسط مولد Gتولید شده اند باید به تمیز دهنده ی D بروند تا به فرایند آموزش تابع موجود در تمیز دهنده D کمک کند. ما به تناوب  به تمیز دهنده D تصاویر حقیقی موجود در دیتاست را نشان می دهیم ( که پارامتر هایش را تغییر خواهد داد تا مقدار کم، نزدیک به صفر را به خروجی دهد) و سپس تصویر تولیدی از مولد G( که پارامتر های تمیز دهنده D را تغییر خواهد داد و مقدار بالاتر، نزدیک به ۱ را به خروجی می دهد). در همین زمان ما از مولد G می خواهیم تا همزمان یاد بگیرد و تصویر واقعی تری که قادر به فریب دادن تمیز دهنده D باشد را تولید کند. ما می خواهیم مولد G مقدار خروجی تمیز دهنده D را کمینه کند درحالی که تمیز دهنده D سعی در بیشینه کردن آن دارد. در حقیقت آنها یک بازی بیشینه کمینه در برابر یکدیگر انجام می دهند. در اینجاست که واژه ی متخاصم موجود در GAN معنی خود را کامل می کند.

این نوع شبکه ها متغیرهای پنهان بسیاری دارند که نیاز به بررسی است. برای درک بهتر می توانیم از ورودی شروع نماییم که از توزیع نرمال استفاده کنیم. همانطور که در شکل بالا مشخص است، آن را با Pz نشان دادیم و بصورت رندوم یک بردار برای آن در نظر می گیریم. با توجه به اینکه توزیع موجود در دیتاست را نمی دانیم آن را با Pdata نشان دادیم. مولد G با توجه به توزیع احتمال ورودی سعی در تولید تصویری حقیقی دارد که بتواند تمیز دهنده ی D را فریب دهد (Pg ). هدف این است که تقریبا Pdata = Pg گردد.
![image](https://user-images.githubusercontent.com/94124607/166116705-14e4d2cc-16f1-4022-ae58-c8ebd81ca772.png)


در حقیقت Pz یک توزیع نرمال از تابع توزیع احتمال می باشد. مانند شکل زیر:
    ![image](https://user-images.githubusercontent.com/94124607/166116718-de9ff9ce-ab41-42c0-bf5b-50a853013bb7.png)

تصویر سمت چپ توزیع نرمال از تابع توزیع احتمال است و شکل سمت راست نمونه ای از تابع توزیع احتمال نرمال می باشد. رابطه ی کلیدی بین تصویر و آمار چیزی است که ما را قادر می سازد تا تصاویر را به عنوان نمونه هایی از یک تابع توزیع چند بعدی تفسیر نمائیم.
در تصویر زیر توزیع های مختلف موجود در علوم داده نشان داده شده است.


روند آموزش شبکه ی GAN ؛ Pg توزیع تصویر تولید شده توسط مولد Gاست که با رنگ سبز و توزیع تصویر دیتاست، با رنگ سیاه و همچنین تمیز دهنده D را با رنگ آبی نشان دادیم. a) تصاویر تولیدی توسط مولد به تصاویر دیتاست شباهت چندانی ندارد. b) وزن دهی تمیزدهنده به روز رسانی شده است در حالی که وزن دهی مولد ثابت مانده است c) وزن دهی مولد به روز رسانی شده درحالی که وزن دهی تمیزدهنده ثابت نگه داشته شده است. d) Pg و Pdata بسیار شبیه به هم شدند.

  <div dir="rtl">
GAN دو کاربرد عمده دارد:
  
تولید تصاویر جدید براساس دیتا های آموزش دیده موجود در دیتاست.
ترمیم تصویر؛ که ممکن است بخشی از تصویر حذف و یا مسدود شده باشد.
در مسئله ی ترمیم تصویر فرض بر این است که تصویری داریم و می خواهیم کمبود و نقایص موجود در تصویر را برطرف کنیم، این کار را با جایگزینی آن با تصویرِ زمینه انجام می دهیم. فرض کنید یک تصویر از یک تعطیلات دوست داشتنی از یک صحنه ی زیبا دارید امّا یک سری افرادی که نمی شناسید نیز در تصویر وجود دارند و باعث از بین رفتن منظره شده اند. برای برطرف کردن این ناهماهنگی در تصویر ممکن است از نرم افزار Photoshop استفاده کنیم. در اینجا دو انتخاب داریم؛ انتخاب اول این است که اگه مشابه تصویر را در دسترس داریم از آن تصویر برای بازسازی بخش مورد نیاز استفاده کنیم. که در اینصورت باید به کل تصویر نگاه کنیم و تصویر متناسب با مفهوم تصویر را برای جایگزینی انتخاب کنیم و یا به عنوان انتخاب دوم اگر مشابه تصویر در دسترس نباشد، تنها راه برای پر کردن قسمت مورد نظر این است که از پیکسل های همسایه برای پرکردن ناحیه¬ی مسدود شده استفاده کنیم و یا اگر بیش از حد دقت داشته باشیم، ممکن است از بخش های مشابه موجود در همان تصویر استفاده کنیم.
روش اول اصطلاحاً روش مبتنی بر درک و روش دوّم اصطلاحاً روش مبتنی بر محتوا نامیده می¬شوند.

در شبکه های مولد متخاصم ورودی شبکه ی مولد، نویز گوسی است و ورودی های شبکه¬ی تمیزدهنده تصاویر تولیدی توسط مولد و تصاویر موجود در دیتاست می باشند. شبکه ی مولد در ابتدا با در اختیار داشتن نویز، تصویری جعلی تولید می نماید. این تصویر به تمیزدهنده می رود. اگر تمیز دهنده تشخیص دهد تصویر تولیدی توسط مولد به میزان کافی حقیقی است، تصویر به خروجی شبکه داده می شود و کار تمام است. اما اگر تمیزدهنده با مقایسه با تصاویر موجود در دیتاست، تصویر را جعلی تشخیص دهد فیدبک به مولد داده می شود تا وزن های خود را بروزرسانی نماید که در نتیجه مولد تصویری حقیقی تر را تولید می نماید و این پروسه تا جایی ادامه می یابد که شبکه ی تمیزدهنده متوجه جعلی بودن تصویر خروجی از مولد نشود.


انواع شبکه های Generative Adversarial Networks:
1- شبکه های مولد متخاصم وانیلا ( شبکه ی اصلی معرفی شده توسط ایان گودفلو) (The Vanilla GAN)

۲- شبکه های مولد متخاصم عمیق کانولوشنی (Deep Convolutional Generative Adversarial Networks)
استفاده از شبکه های عصبی کانولوشنی استفاده شده در یادگیری بدون ناظر هم در مولد و هم در تمیز دهنده.
برای مثال در شبکه ی توسعه داده شده توسط Nvidia برای تولید تصاویر که در شبکه ی تمیز دهنده از CNN برای تشخیص تصویر چهره ی حقیقی از غیر حقیقی مورد استفاده قرار گرفته است و در شبکه ی مولد برای تولید تصویر صورت از یک سری دیتای اولیه ( در اینجا نویز گوسی) و با استفاده از DeCNN تصویر حقیقی تر و با کیفیت بالاتری تولید گردیده است.

۳- شبکه ی مولد متخاصم شرطی (Conditional Generative Adversarial Networks):
می توان به شبکه امر کرد که چه نوع دیتایی تولید نماید. به عنوان مثال دیتاست اعداد ۰ تا ۹ را در نظر بگیرید که هر کدام از آنها در شبکه ی مولد متخاصم معمول شبکه قادر به تولید تصاویر رندوم از اعداد است. اما در این نوع شبکه ما می توانیم با تغذیه ی ورودی C یک شرط برای آن تعریف نماییم تا تنها مورد دلخواهمان را تولید کند.

![image](https://user-images.githubusercontent.com/94124607/166116726-b3c580c0-c96c-471c-afeb-288b6a5bbcfe.png)

تولید تصویر اشخاص با ژست مشخص (Pose Guided Person Image Generation)


۳-انتقال دامنه ی سطح پیکسل (PixelDTGAN)


۴-رزولوشن فوق العاده (Super Resolution)
![image](https://user-images.githubusercontent.com/94124607/166116732-95272ba0-8ba2-4846-9ae3-4883cb175857.png)


۵-رشد تصاعد ی شبکه های مولد متخاصم (Progressive growing of GANs)


۶-سنتز تصاویر کیفیت بالا (High-resolution image synthesis)
دقیقا برعکسِ قطعه بندی تصویر ( Image Segmentation)


۷-تبدیل متن به تصویر (Text to image)
![image](https://user-images.githubusercontent.com/94124607/166116743-91a9da7d-9936-4eea-bcfd-dcabee968e99.png)


۸-سنتز صورت (Face synthesis)

![image](https://user-images.githubusercontent.com/94124607/166116759-195770eb-1467-4025-963b-6869deb9ae24.png)

۹-ترمیم تصویر (Image inpainting)


۱۰-تبدیل تصویر به تصویر (Image to Image (pix2pix)



این ها نمونه هایی از تحقیقات صورت گرفته تا به امروز هستند.

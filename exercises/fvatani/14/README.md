# شبکه‌های مولد متخاصم

شبکه‌های مولد متخاصم یا به اختصار GAN، رویکردی برای مدل‌سازی مولد با استفاده از روش‌های یادگیری عمیق، مانند شبکه‌های عصبی کانولوشنال است. مدل‌سازی مولد یک فعالیت نظارت نشده در یادگیری ماشین است که شامل اکتشاف خودکار و یادگیری قواعد یا الگو‌های موجود در داده‌های ورودی است. این‌کار به گونه‌ای انجام می‌شود که از مدل می‌توان برای تولید یا خروجی گرفتن نمونه‌های جدیدی از مجموعه داده اصلی استفاده کرد. شبکه‌های عصبی مولد، یک زمینه مهیج و به سرعت در حال رشد هستند که وعده خود مبنی بر داشتن توانایی تولید نمونه‌های واقعی در طیف گوناگونی از مسائل را محقق کرده‌اند. از جمله برجسته‌ترین این مسائل، تبدیل تصویر به تصویر است. به عنوان مثالی از تبدیل تصویر به تصویر، می‌توان به تبدیل تصاویر تابستان به زمستان، تصاویر روز به شب و تولید تصاویر فوتورئالیستیک از‌اشیا، صحنه‌ها و افراد اشاره کرد. این تصاویر به گونه‌ای تولید می‌شوند که حتی انسان‌ها نیز نمی‌توانند بگویند تصاویر جعلی هستند.

## مدل مولد چیست؟
در این بخش، ‌ایده اصلی مدل‌های مولد، پارادایم‌های یادگیری نظارت نشده و نظارت شده و مدل‌سازی متمایزگر و مولد تشریح می‌شود.
### یادگیری نظارت شده و نظارت نشده
در یک مسأله یادگیری ماشین معمول، از یک مدل برای انجام پیش‌بینی و برای مثال مدل‌سازی پیش‌بین استفاده می‌شود. این کار نیازمند یک مجموعه داده آموزش است که برای آموزش دادن یک مدل مورد استفاده قرار می‌گیرد و ترکیبی از چندین مثال است که به آن‌ها نمونه گفته می‌شود. هر یک از این نمونه‌ها دارای یک متغیر ورودی X و برچسب کلاس Y هستند. مدل با مشاهده نمونه‌ها آموزش می‌بینید و سپس، برای پیش‌بینی نمونه‌های جدید مورد استفاده قرار می‌گیرد. همچنین، مدل برای ایجاد خروجی‌هایی که بیشتر به خروجی مورد انتظار نزدیک هستند نیز آموزش می‌بیند.

|![image](https://github.com/semnan-university-ai/image-processing-class-002/blob/main/exercises/fvatani/14/1.jpg)|
|:--:| 
| *نمونه ای از یادگیری باناظر* |

این اصلاح مدل عموماً با عنوان شکل نظارت شده یادگیری یا یادگیری نظارت شده نامیده می‌شود. از جمله مسائل یادگیری نظارت شده می‌توان به دسته‌بندی و رگرسیون اشاره کرد و به عنوان مثال‌هایی از الگوریتم‌های یادگیری نظارت شده می‌توان از رگرسیون لجستیکو جنگل تصادفی نام برد. پارادایم دیگری از یادگیری وجود دارد که طی آن، فقط متغیر ورودی X به مدل داده می‌شود و مسأله هیچ متغیر خروجی y ندارد. بنابراین، مدل با استخراج یا خلاصه‌سازی الگو‌های موجود در داده‌ها ساخته می‌شود. هیچ اصلاح مدلی برای این نوع از مدل‌ها اتفاق نمی‌افتد و مدل چیزی را پیش‌بینی نمی‌کند.

 |![image](https://github.com/semnan-university-ai/image-processing-class-002/blob/main/exercises/fvatani/14/2.jpg)|
 |:--:| 
| *نمونه ای از یادگیری بدون ناظر* |
  
از جمله مسائل یادگیری نظارت نشده می‌توان به خوشه‌بندی و مدل‌های مولد اشاره کرد. الگوریتم‌های K-Means و شبکه عصبی تخاصمی از جمله الگوریتم‌های نظارت نشده هستند.
  ### مدل‌سازی مولد و مدل‌سازی متمایزگر
در یادگیری نظارت شده، ممکن است تمایل به توسعه مدلی وجود داشته باشد که برچسب کلاس را با دریافت مثالی از متغیر‌های ورودی پیش‌بینی کند. کار مدل‌سازی پیش‌بینی دسته‌بندی نامیده می‌شود. به دسته‌بندی به طور سنتی مدل‌سازی متمایزگر نیز گفته می‌شود. این کار به این دلیل است که مدل باید مثال‌های متغیر‌های ورودی را در سرتاسر کلاس‌ها متمایز کند. مدل باید تصمیم بگیرد که یک مثال داده شده به کدام دسته تعلق دارد.

| ![image](https://github.com/semnan-university-ai/image-processing-class-002/blob/main/exercises/fvatani/14/3.jpg)|
|:--:| 
| *نمونه ای از مدل‌سازی متمایزگر* |

این در حالی است که مدل‌های یادگیری نظارت نشده که توزیع متغیر‌های ورودی را خلاصه می‌کنند، ممکن است برای ساخت یا تولید نمونه‌های جدید در توزیع ورودی مورد استفاده قرار بگیرند. از این رو، این مدل‌ها مدل‌های مولد نامیده می‌شوند.
  
  | ![image](https://github.com/semnan-university-ai/image-processing-class-002/blob/main/exercises/fvatani/14/4.jpg)|
|:--:| 
| *نمونه ای از مدل‌سازی مولد* |

برای مثال، یک متغیر مجرد ممکن است یک توزیع شناخته شده مانند توزیع گوسی یا زنگوله‌ای و یا همان توزیع نرمال داشته باشد. یک مدل مولد ممکن است قادر باشد به طور مؤثری این توزیع داده‌ها را خلاصه و سپس برای تولید متغیر‌های جدیدی استفاده کند که به صورت قابل باوری در توزیع برازش Fit می‌شوند. در حقیقت، یک مدل مولد خیلی خوب ممکن است قادر به تولید مثال‌های جدیدی باشد که نه تنها قابل باور هستند، بلکه از مثال‌های واقعی دامنه مسأله نیز قابل تمایز نیستند.


### مثال‌هایی از مدل‌های مولد
بیز ساده مثالی از مدل‌های مولد است که اغلب به عنوان یک مدل متمایزگر مورد استفاده قرار می‌گیرد. برای مثال، بیز ساده با خلاصه‌سازی توزیع احتمال هر متغیر ورودی و کلاس خروجی کار می‌کند. هنگامی که پیش‌بینی انجام شد، احتمال هر خروجی ممکن برای هر متغیر محاسبه می‌شود؛ احتمال‌های مستقل ترکیب می‌شوند و محتمل‌ترین خروجی پیش‌بینی می‌شود. به طور معکوس، توزیع احتمال هر متغیر را می‌توان برای تولید مقادیر ویژگی مستقل قابل باور نمونه‌گیری کرد. مثال دیگری از مدل‌های مولد، تخصیص پنهان دیریکله و مدل آمیخته گاوسی محسوب می‌شوند.
روش‌های یادگیری عمیق را می‌توان به عنوان مدل‌های مولد استفاده کرد. دو مثال متداول از این الگوریتم‌ها ماشین بولتزمن محدود و شبکه باور عمیق هستند. دو مثال مدرن از الگوریتم‌های مدل‌سازی مولد یادگیری عمیق می‌توان به خود کدگذار متغیر و شبکه عصبی مولد اشاره کرد.
  
## شبکه عصبی مولد چیست؟
شبکه عصبی مولد مدل مولد مبتنی بر یادگیری عمیق است. به طور کلی، شبکه‌های عصبی مولد معماری برای آموزش یک مدل مولد هستند و متداول‌تر است که از مدل‌های یادگیری عمیق در این معماری استفاده شود. معماری GAN اولین بار در سال ۲۰۱۴ در مقاله‌ای که توسط‌ایان گوفلو و همکارانش با عنوان شبکه‌های مولد تخاصمی نوشته شده بود، معرفی شدند. یک رویکرد استاندارد شده که شبکه‌های مولد تخاصمی پیچشی عمیق نامیده می‌شود منجر به مدل‌های پایدارتری می‌شود که بعد‌ها توسط الک رادفورد و همکاران در مقاله‌ای با عنوان یادگیری ارائه نظارت نشده با شبکه‌های مولد تخاصمی پیچشی عمیق که در سال ۲۰۱۶ منتشر شد، معرفی شدند.
معماری مدل GAN شامل دو زیر مدل است: یک مدل مولد برای تولید نمونه‌های جدید و یک مدل متمایزگر برای دسته‌بندی نمونه‌های تولید شده در دو دسته واقعی از دامنه و جعلی که توسط مدل مولد ساخته شده است.

**مولد:**  مدلی که برای تولید مثال‌های قابل باور جدید از دامنه مسأله مورد استفاده قرار می‌گیرد.

**متمایزگر:**  مدلی که برای دسته‌بندی مثال‌ها به عنوان واقعی از دامنه یا جعلی ساخته شده توسط مدل مولد مورد استفاده قرار می‌گیرد.
  
### مدل مولد
مدل مولد یک بردار تصادفی با طول ثابت را به عنوان ورودی دریافت و نمونه‌ها را در دامنه تولید می‌کند. بردار به طور تصادفی از یک توزیع گوسی برگرفته شده و بردار برای دانه دادن به فرایند مولد مورد استفاده قرار می‌گیرد. پس از آموزش دادن، نقاط در این فضای‌برداری چندبُعدی متناظر با نقاط در دامنه مسأله خواهند بود و یک ارائه فشرده از توزیع داده‌ها را ارائه می‌کنند. فضای‌برداری با عنوان فضای پنهان یا یک فضای‌برداری متشکل از متغیر‌های پنهان نامیده می‌شود. متغیر‌های پنهان یا متغیر‌هایی هستند که برای دامنه حائز اهمیت هستند اما به طور مستقیم قابل مشاهده نیستند.
معمولاً از متغیر‌های پنهان یا فضای پنهان با عنوان تصویر یا فشرده‌سازی توزیع داده یاد می‌شود. این مورد، فضای پنهانی است که فشرده‌سازی یا مفهوم سطح بالا از داده‌های خام مشاهده شده مانند توزیع داده‌های ورودی را فراهم می‌کند. در GAN‌ها، مدل مولد، به نقاط در فضای پنهان معنا می‌بخشد؛ به طوری که نقاط جدیدی که برگرفته از فضای پنهان هستند را می‌توان برای مدل مولد به عنوان ورودی قرار داد و از آن‌ها برای تولید خروجی‌های جدید و متفاوت استفاده کرد.
پس از آموزش، مدل مولد برای تولید نمونه‌های جدید حفظ و استفاده می‌شود.

| ![image](https://github.com/semnan-university-ai/image-processing-class-002/blob/main/exercises/fvatani/14/5.jpg)|
|:--:| 
| *نمونه ای از مدل مولد شبکه‌های مولد متخاصم* |

### مدل متمایزگر
مدل متمایزگر، نمونه‌ای از دامنه را به عنوان ورودی واقعی یا تولید شده دریافت و برچسب کلاس دودویی را واقعی یا جعلی پیش‌بینی می‌کند. مثال‌های واقعی از مجموعه داده آموزش می‌آیند. مثال‌های تولید شده خروجی مدل مولد هستند. متمایزگر یک مدل دسته‌بندی طبیعی و به خوبی درک شده است. پس از فرایند آموزش، مدل متمایزگر کنار گذاشته می‌شود، زیرا مدل مولد است که جذابیت دارد. گاهی اوقات، مولد را می‌توان باز هدف‌گذاری کرد، زیرا به خوبی یاد گرفته است که ویژگی‌ها را در دامنه مسأله استخراج کند. برخی یا تمام لایه‌های استخراج ویژگی را می‌توان در کاربرد‌های یادگیری انتقال با استفاده از همان داده‌ها یا داده‌های مشابه استفاده کرد.

 |![image](https://github.com/semnan-university-ai/image-processing-class-002/blob/main/exercises/fvatani/14/6.jpg)|
 |:--:| 
| *نمونه ای از مدل متمایزگر شبکه‌های مولد متخاصم* |

### شبکه‌های مولد تخاصمی به عنوان یک بازی دو بازیکنی
همانطور که پیش از این گفته شد، مدل‌سازی مولد از جمله مسائل یادگیری نظارت نشده است. یکی از خصوصیات هوشمندانه معماری GAN آموزش دادن مدل مولد به عنوان یک مسأله یادگیری نظارت شده قاب‌بندی شده است. دو مدل مولد و متمایزگر، با یکدیگر آموزش می‌بینند. مولد، دسته‌ای از نمونه‌ها را آماده می‌کند و این دسته، همراه با مثال‌هایی از دامنه، برای متمایزگر فراهم و به عنوان واقعی یا جعلی دسته‌بندی می‌شوند. مولد سپس به روز‌رسانی می‌شود تا در تمایز بین نمونه‌های واقعی و جعلی در دور بعدی بهتر عمل کند. مهم‌تر آنکه، مولد نیز بر پایه اینکه متمایزگر با نمونه تولید شده به اندازه کافی خوب گول خورده است یا خیر نیز به روز‌رسانی می‌شود.
در این شرایط، مجموع صفر به معنای هنگامی است که متمایزگر با موفقیت نمونه‌های واقعی و جعلی را تشخیص دهد، این کار پاداش‌دهی می‌شود و یا هیچ تغییری برای پارامتر‌های مدل مورد نیاز نیست، در حالی‌که مولد با به روز‌رسانی گسترده در پارامتر‌های مدل جریمه می‌شود.
در عین حال، شرایطی وجود دارد که طی آن مولد در هر بار جایگزین‌های خیلی خوبی از دامنه ورودی را تولید می‌کند و متمایزگر نمی‌تواند تفاوت آن‌ها را از نمونه‌های واقعی و غیرجعلی تشخیص دهد و بنابراین برچسب دسته را غیر مطمئن پیش‌بینی می‌کند برای مثال، ٪۵۰ برای واقعی و جعلی. این امر تنها مثالی از یک شرایط‌ایده‌آل است. نیازی برای رسیدن به این نقطه به منظور رسیدن به مدل مولد کارآمد وجود ندارد.

 ![image](https://github.com/semnan-university-ai/image-processing-class-002/blob/main/exercises/fvatani/14/7.jpg)
 |:--:| 
| *نمونه ای از معماری مدل شبکه مولد تخاصمی* |

### شبکه‌های مولد تخاصمی و شبکه‌های عصبی پیچشی
شبکه‌های مولد تخاصمی به طور معمول با داده‌های تصویری کار می‌کنند و از شبکه‌های عصبی پیچشی به عنوان مدل مولد و متمایزگر بهره می‌برد. دلیل این امر آن است که اولین توصیف از این روش در زمینه بینایی کامپیوتری ارائه و از شبکه‌های عصبی پیچشی و داده‌های تصویری برای آن استفاده شده است؛ همچنین، به دلیل پیشرفت قابل توجه بینایی کامپیوتری که با استفاده از شبکه‌های عصبی پیچشی در سال‌های اخیر به وقوع پیوسته، و شبکه‌های عصبی پیچشی بیشتر به نتایج لبه علم در زمینه بینایی کامپیوتر مانند شناسایی‌اشیا و تشخیص چهره دست یافته‌اند از این نوع شبکه‌های در شبکه‌های مولد تخاصمی استفاده می‌شود.
مدل‌سازی داده‌های تصویری بدین معنا است که فضای پنهان، ورودی مولد، یک ارائه فشرده از مجموعه‌ای از تصاویر فراهم می‌کند که برای آموزش دادن مدل مورد استفاده قرار می‌گیرند. این بدین معنا است که مولد، تصاویر جدید و خروجی را تولید می‌کند که به سادگی قابل مشاهده و ارزیابی توسط توسعه‌دهندگان یا کاربران مدل است. این حقیقت ممکن است بر دیگر موارد ارجحیت داشته باشد که توانایی ارزیابی بصری کیفیت خروجی تولید شده، که هر دو را دارد، منجر به تمرکز بر کاربرد‌های بینایی کامپیوتری با CNN در مقایسه با دیگر مدل‌های مبتنی بر یادگیری عمیق می‌شود.
  
 ### شبکه‌های مولد عصبی شرطی
یک افزونه مهم از شبکه‌های عصبی مولد، مربوط به کاربرد آن‌ها برای تولید شرطی خروجی‌ها است. مدل مولد می‌تواند به گونه‌ای آموزش ببیند که مثال‌های جدید را از دامنه ورودی تولید کند، در حالی‌که ورودی، بردار تصادفی از فضای پنهان، به صورت شرطی با برخی از ورودی‌های اضافی فراهم شده است. ورودی اضافی می‌تواند یک مقدار کلاس مانند مرد یا زن در تولید تصاویر از افراد و یا ارقام در تولید تصاویر از مقادیر نوشته شده با دست باشد.
متمایزگر نیز شرطی شده است، بدین معنا که هم داده ورودی که واقعی یا جعلی است و هم ورودی اضافی را فراهم می‌کند. در ورودی شرطی نوع برچسب دسته‌بندی، متمایزگر انتظار دارد که ورودی آن دسته، در عوض به مولد بیاموزد که نمونه‌هایی از آن کلاس را به منظور گول زدن متمایزگر تولید کند. بدین شکل، یک شبکه مولد تخاصمی می‌تواند برای تولید مثال‌هایی از دامنه یک نوع داده شده مورد استفاده قرار بگیرد. با برداشتن یک گام رو به جلوتر، مدل‌های شبکه مولد تخاصمی می‌تواند روی یک مسأله از دامنه مانند یک تصویر شرطی شود. این کار، به شبکه‌های مولد تخاصمی امکان کاربرد‌هایی مانند تبدیل متن به تصویر یا تبدیل تصویر به تصویر را می‌دهد. این کار برای برخی از کاربرد‌های قابل توجه شبکه‌های مولد تخاصمی مانند انتقال سبک، رنگ‌آمیزی تصاویر، نگاشت تصاویر از تابستان به زمستان یا از روز به شب و چنین مواردی کاربرد دارد.
در شبکه‌های مولد تخاصمی شرطی برای تبدیل تصویر به تصویر، مانند نگاشت تصاویر روز به شب، متمایزگر نمونه‌هایی از تصاویر شبانه واقعی و تولید شده را همراه با تصاویر واقعی روز شرط گذاشته شده بر آن‌ها را به عنوان ورودی فراهم می‌کند. مولد، با یک بردار تصادفی از فضای پنهان و تصاویر روز واقعی شرط گذاشته شده به عنوان ورودی فراهم شده است.

 |![image](https://github.com/semnan-university-ai/image-processing-class-002/blob/main/exercises/fvatani/14/8.jpg)|
 |:--:| 
| *نمونه ای از معماری مدل شبکه عصبی شرطی* |

## چرا شبکه‌های مولد تخاصمی؟
یکی از مهم‌ترین پیشرفت‌ها در استفاده از روش‌های یادگیری عمیق در دامنه‌هایی مانند بینایی کامپیوتری، روشی است که داده‌افزایی نامیده می‌شود. نتایج داده‌افزایی در مدل‌های با کارایی بهتر، هم مهارت مدل را افزایش می‌دهند و هم یک اثر تنظیم‌کننده به همراه دارند که خطای تعمیم را کاهش می‌دهد. داده‌افزایی با ساخت نمونه‌های جدید، مصنوعی ولی قابل اعتماد از دامنه مسأله ورودی کار می‌کند که مدل روی آن آموزش دیده است.
روش‌ها برای داده‌های تصویری، اولیه و شامل بدنه، چرخش‌ها، بزرگ‌نمایی‌ها و دیگر تبدیل‌های ساده تصاویر موجود در مجموعه داده آموزش هستند. مدل‌سازی مولد موفق، یک جایگزین و رویکرد دامنه‌محورتر را برای داده‌افزایی فراهم می‌کند. در حقیقت، داده‌افزایی نسخه ساده شده مدل‌سازی مولد است، اگرچه به ندرت به این شکل توصیف می‌شود.
ر دامنه‌های پیچیده یا دامنه‌هایی با حجم محدودی از داده‌ها، مدل‌سازی مولد مسیری به سوی آموزش بیشتر برای مدل‌سازی فراهم می‌کند. GAN‌ها شاهد موفقیت‌های بیشتری در چنین مواردی در دامنه‌هایی مانند یادگیری تقویتی عمیق بوده‌اند. دلایل تحقیقاتی زیادی پیرامون اینکه چرا GAN‌ها جذاب، مهم و نیازمند پژوهش بیشتر هستند وجود دارد. ‌ایان گودفلو تعدادی از این موارد را در سخنرانی کلیدی خود با عنوان راهنمای سال ۲۰۱۶ NIPS: شبکه‌های مولد تخاصمی در کنفرانس سال ۲۰۱۶ بیان می‌کند.
در میان این دلایل، او توانایی موفق GAN برای مدل‌سازی داده‌های ابعاد بالا، اداره مقادیر ناموجود و ظرفیت GAN‌ها برای فراهم کردن خروجی‌های چند مدلی یا پاسخ‌های قابل اعتماد چندگانه را برجسته می‌سازد. احتمالاً، مهم‌ترین کاربرد GAN‌ها برای وظایفی است که نیازمند تولید مثال‌های جدید هستند. در اینجا، گودفلو سه مثال نشان می‌دهد:
- فراتفکیک‌پذیری. توانایی تولید نسخه‌های با کیفیت از تصاویر ورودی.
- ساخت آثار هنری. توانایی ساخت تصاویر، پیش‌طرح‌ها، نقاشی‌ها و دیگر موارد جدید و هنری.
- تبدیل تصویر به تصویر. توانایی انتقال تصاویر در دامنه‌های گوناگون، مثلاً از روز به شب، از تابستان به زمستان و دیگر موارد.
 
احتمالاً متقاعد‌کننده‌ترین دلیل برای اینکه GAN‌ها به طور گسترده مورد مطالعه، توسعه و استفاده قرار می‌گیرند، موفقیت‌های آن‌ها است. GAN‌ها قادر به تولید کردن تصاویر بسیار واقعی و به صورتی هستند که انسان‌ها نیز قادر به تشخیص و بیان آن نیستند که این تصاویر متعلق به‌اشیا، صحنه‌ها و انسان‌هایی هستند که در دنیای واقعی وجود خارجی ندارند. حتی واژه شگفت‌انگیز نیز از بیان توانایی این روش‌ها قاصر است.

 |![image](https://github.com/semnan-university-ai/image-processing-class-002/blob/main/exercises/fvatani/14/9.jpg)|
 |:--:| 
| *نمونه ای از پیشرفت توانایی‌های شبکه‌های مولد متخاصم از سال ۲۰۱۴ تا ۲۰۱۷* |

منبع:         [A Gentle Introduction to Generative Adversarial Networks (GANs)](https://machinelearningmastery.com/what-are-generative-adversarial-networks-gans/)

